<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link rel="apple-touch-icon" href="static/images/apple-touch-icon.png">
  <link rel="manifest" href="static/images/site.webmanifest">
  <title>Using your Macbook Pro M3 GPU with TensorFlow - MLOwl.ca</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" />
  <style>
    :root {
      --main-color: #0077cc;
      --font-body: 'Poppins', sans-serif;
      --max-width: 800px;
    }

    body {
      font-family: var(--font-body);
      margin: 0;
      padding: 0;
      background-color: #f5f7fa;
      color: #222;
    }

    .container {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    header {
      margin-bottom: 2rem;
    }

    .featured-image {
      margin-bottom: 1.5rem;
      text-align: center; /* Center the credit text */
    }

    .featured-image img {
      width: 100%;
      height: auto;
      border-radius: 8px;
      margin-bottom: 0.3rem; /* Tight space between image and credit */
    }

    .image-credit {
      font-size: 0.85rem;
      color: #666;
      margin-top: 0; /* Remove space above */
    }

    header img {
      width: 100%;
      height: auto;
      border-radius: 8px;
      margin-bottom: 1.5rem;
    }

    h1 {
      font-size: 2.25rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .date {
      color: #666;
      font-size: 0.95rem;
      margin-bottom: 2rem;
    }

    p {
      font-size: 1rem;
      line-height: 1.75;
      margin-bottom: 1.5rem;
    }

    a {
      color: var(--main-color);
      text-decoration: none;
      font-weight: 600;
      border-bottom: 2px solid transparent;
      transition: border-color 0.3s;
    }

    a:hover {
      border-color: var(--main-color);
    }

    footer {
      margin-top: 3rem;
      font-size: 0.95rem;
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 1.75rem;
      }

      .container {
        padding: 1.5rem 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <!-- Optional Featured Image -->
      <div class="featured-image">
      <img src="static/images/TF_icon8_M3_Apple.jpg" alt="Using your Macbook Pro M3 GPU with TensorFlow featured images by icon8.com & apple.com, assembled image by Martin Bijloos" />
        <div class="image-credit">Images by icons8.com and apple.com, assembled image by Martin Bijloos</div>
      </div>
      <h1>Using your Macbook Pro M3 GPU with TensorFlow</h1>
      <p class="byline">By Martin Bijloos, MLOwl.ca | June 23, 2025</p>
    </header>

    <main>
      <h2>üöÄ Accelerating TensorFlow 2 on a MacBook Pro M3: A Step-by-Step Guide</h2>

      <p>When I started training a vision model to classify dog breeds using TensorFlow, I was excited to tap into the powerful M3 Pro chip inside my MacBook Pro. In theory, Apple's GPU-accelerated machine learning support should "just work" ‚Äî but in reality, it took hours of research, trial-and-error, and sorting through compatibility snags.</p>

      <p>So, I wrote this guide to help future me ‚Äî and hopefully you ‚Äî cut through the noise and get up and running with TensorFlow 2 and Apple Silicon GPU support on macOS.</p>

      <h3>üß† Why Use the M3 Pro‚Äôs GPU?</h3>

      <p>Apple Silicon chips (like the M3, M2, and M1) include integrated GPUs that can significantly accelerate TensorFlow workflows ‚Äî especially for vision tasks involving image classification, object detection, and style transfer. If you're training on unstructured data (e.g. photos of dogs üê∂), leveraging the GPU gives you a big boost.</p>

      <p>But the setup? It's a bit finicky unless you follow a precise recipe.</p>

      <h2>üõ†Ô∏è Setup Instructions</h2>

      <p>Here‚Äôs the exact process I used to get TensorFlow 2 running with GPU support on macOS with my M3 Pro.</p>

      <h3>üìÅ Step 1 ‚Äì Create Your Project Directory</h3>

      <pre><code class="language-bash">cd ~/Desktop</code></pre>
      <pre><code class="language-bash">mkdir dog-breed-identification-project</code></pre>
      <pre><code class="language-bash">cd dog-breed-identification-project</code></pre>
      </code></pre>

      <h3>üêç Step 2 ‚Äì Create a Conda Environment with Python 3.11.11 inside your project folder.</h3>

      <p><strong>Important:</strong> TensorFlow 2.15 is compatible with Python 3.11.11, and supports Apple GPU via <code>tensorflow-metal</code>.</p>

      <pre><code class="language-bash">conda create --prefix ./env python==3.11.11</code></pre>
      <pre><code class="language-bash">conda activate ./env</code></pre>

      <h3>üîß Step 3 ‚Äì Install TensorFlow and GPU Support</h3>

      <pre><code class="language-bash">python -m pip install tensorflow==2.15</code></pre>
      <pre><code class="language-bash">python -m pip install tensorflow-metal==1.1.0</code></pre>

      <h3>‚úÖ Step 4 ‚Äì Verify TensorFlow Installation (in Python)</h3>

      <pre><code class="language-python"># python</code></pre>
      <pre><code class="language-python">import tensorflow as tf</code></pre>
      <pre><code class="language-python">print(tf.__version__)</code></pre>

      <p>If you don‚Äôt get any errors and see <code>2.15.0</code>, you're in business.</p>

      <h3>üì¶ Step 5 ‚Äì Install Additional Libraries</h3>

      <p>You‚Äôll need common data science libraries ‚Äî but be careful not to mess with TensorFlow's NumPy dependency. TensorFlow comes with a compatible NumPy version and does not need to be installed.</p>

      <pre><code class="language-bash">python -m pip install matplotlib==3.8.3</code></pre>
      <pre><code class="language-bash">python -m pip install pandas==2.2.1</code></pre>
      <pre><code class="language-bash">python -m pip install scikit-learn==1.3.2</code></pre>

      <p><strong>‚ö†Ô∏è If you see a warning about <code>chardet</code> in your Jupyter Notebook, fix it with:</strong></p>

      <pre><code class="language-bash">conda install chardet</code></pre>
      <pre><code class="language-bash"># or</code></pre>
      <pre><code class="language-bash">pip install chardet</code></pre>


      <h3>üåê Step 6 ‚Äì (Optional) Install TensorFlow Hub</h3>

      <p>If you plan to use pre-trained models (like MobileNet or EfficientNet), install:</p>

      <pre><code class="language-bash">python -m pip install tensorflow-hub==0.15</code></pre>

      <h2>üêï What‚Äôs Next?</h2>

      <p>With everything set up, you‚Äôre ready to feed your model unstructured data; in my case images of German Shepherds, French Bulldogs, and all the adorable breeds in between at incredible computing speeds! Enjoy exploring and using Google's open source TensorFlow library.</p>

      <h3>üí° Final Tips</h3>
      <ul>
        <li>Virtual environments are key to keep your Python and library versions locked for reproducibility.</li>
        <li>Always check for <code>tensorflow-metal</code> compatibility before a new macOS or TensorFlow update.</li>
        <li>You can confirm GPU availability for your model training in TensorFlow with:</li>
        <pre><code class="language-python"># Check for GPU availability in Python</code></pre>
        <pre><code class="language-python">print('GPU', 'available (Woohoo!)'
          if tf.config.list_physical_devices('GPU')
          else 'not available :(')</code></pre>
      </ul>

      <p>If this helped you, drop me a line or share the post. And if you run into issues ‚Äî compatibility, versions, weird errors ‚Äî I‚Äôve probably been there too. Let‚Äôs debug together.</p>

      <!-- Add more paragraphs or content as needed -->

    </main>

    <footer>
      <a href="index.html">‚Üê Back to Home</a>
    </footer>
  </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
</body>
</html>